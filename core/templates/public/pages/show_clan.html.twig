{% extends 'public/base.html.twig' %}

{% set showPortalShell = false %}
{% set contentClass = 'w-full max-w-none px-4 py-8 sm:px-8 lg:px-12 bg-slate-950' %}

{% block title %}{{ page.title }} ¬∑ {{ siteTitle }}{% endblock %}

{% block content %}
<div class="space-y-10 text-slate-100">
    <div class="mx-auto w-full max-w-6xl space-y-10">
        <nav class="rounded-2xl border border-emerald-500/20 bg-slate-950/80 px-6 py-5 text-slate-100 shadow-xl backdrop-blur">
            <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
                <div class="flex items-center gap-4">
                    <div class="flex h-11 w-11 items-center justify-center rounded-xl border border-emerald-500/30 bg-slate-900 text-base font-bold text-white">
                        <span class="text-[9px] font-semibold leading-tight tracking-wide text-center text-white">Clan</span>
                    </div>
                    <div>
                        <p class="text-[11px] uppercase tracking-[0.2em] text-emerald-200/80">Clan Command Center</p>
                        <p class="text-xs text-emerald-200/60">Community, Teams & Events</p>
                    </div>
                </div>
                <div class="flex flex-wrap items-center gap-4 text-[11px] uppercase tracking-[0.2em] text-emerald-200/80">
                    <a href="/startseite" class="hover:text-white">Start</a>
                    <a href="/teams" class="hover:text-white">Teams</a>
                    <a href="/server" class="hover:text-white">Server</a>
                    <a href="/events" class="hover:text-white">Events</a>
                    <a href="/blog" class="hover:text-white">Blog</a>
                    <a href="/ueber-uns" class="hover:text-white">√úber uns</a>
                    <a href="/kontakt" class="hover:text-white">Kontakt</a>
                    <a href="https://shop.example.com" class="hover:text-white">Merch-Shop</a>
                </div>
                <div class="flex flex-wrap items-center gap-3 text-sm text-emerald-100/80">
                    {% if currentUser %}
                        {% set portalPath = '/dashboard' %}
                        {% set portalLabel = t('customer_portal', page_locale()) %}
                        {% if is_granted('ROLE_ADMIN') %}
                            {% set portalPath = '/admin' %}
                            {% set portalLabel = t('admin_portal', page_locale()) %}
                        {% elseif is_granted('ROLE_RESELLER') %}
                            {% set portalPath = '/reseller/customers' %}
                            {% set portalLabel = t('reseller_portal', page_locale()) %}
                        {% endif %}
                        <details class="relative">
                            <summary class="cursor-pointer rounded-full border border-emerald-500/40 px-3 py-1 text-xs font-semibold text-emerald-100 hover:border-emerald-400">
                                {{ t('hosting_user_menu_label', page_locale()) }}
                            </summary>
                            <div class="absolute right-0 mt-2 w-40 rounded-xl border border-emerald-500/30 bg-slate-950/95 p-2 text-xs shadow-xl">
                                <a href="{{ portalPath }}" class="block rounded-lg px-3 py-2 text-emerald-100 hover:bg-slate-900">{{ portalLabel }}</a>
                                <a href="{{ path('public_logout') }}" class="block rounded-lg px-3 py-2 text-emerald-100 hover:bg-slate-900">{{ t('logout', page_locale()) }}</a>
                            </div>
                        </details>
                    {% else %}
                        <a href="{{ path('public_login') }}" class="rounded-full border border-emerald-500/40 px-3 py-1 text-xs font-semibold text-emerald-100 hover:border-emerald-400">{{ t('login', page_locale()) }}</a>
                        <a href="{{ path('public_register') }}" class="rounded-full bg-emerald-500 px-3 py-1 text-xs font-semibold text-slate-950 hover:bg-emerald-400">{{ t('register', page_locale()) }}</a>
                    {% endif %}
                    <span class="text-emerald-200/60">üîç</span>
                    <a href="/mitmachen" class="rounded-full bg-emerald-500 px-4 py-2 font-semibold text-slate-950 shadow-lg shadow-emerald-500/20 hover:bg-emerald-400">Mitmachen</a>
                </div>
            </div>
        </nav>

        <section class="relative overflow-hidden rounded-3xl border border-emerald-500/20 bg-slate-950">
            <div class="absolute inset-0" style="background-image: radial-gradient(circle at top, rgba(16, 185, 129, 0.2), transparent 60%);"></div>
            <div class="absolute inset-0 bg-cover bg-center opacity-25" style="background-image: url('https://images.unsplash.com/photo-1520975682031-ae55a189b0b3?auto=format&fit=crop&w=1600&q=80');"></div>
            <div class="relative px-10 py-12">
                <p class="text-xs uppercase tracking-[0.3em] text-emerald-300">Clan Operations</p>
                <h1 class="mt-3 text-4xl font-bold tracking-wide text-white">{{ page.title }}</h1>
                <p class="mt-3 max-w-2xl text-sm text-slate-400">
                    Willkommen ‚Äì hier findest du unser Team, Events, Community-News und alle freigegebenen Game-Server auf einen Blick.
                </p>
            </div>
        </section>

        <div class="grid gap-8 lg:grid-cols-[2fr_1fr]">
            <section class="space-y-6">
                {% for block in blocks %}
                    <div class="rounded-2xl border border-emerald-500/20 bg-slate-900/80 p-6 shadow-xl backdrop-blur">
                        {% if block.type in ['server_list', 'server_featured'] %}
                            {% include 'public/servers/_server_list.html.twig' with {
                                servers: block.servers,
                                show_players: block.settings.show_players,
                                show_join_button: block.settings.show_join_button,
                                theme: 'emerald-dark'
                            } %}
                        {% else %}
                            <div class="prose max-w-none text-slate-200">{{ block.content|raw }}</div>
                        {% endif %}
                    </div>
                {% else %}
                    <div class="rounded-2xl border border-emerald-500/20 bg-slate-900/80 p-6 text-sm text-emerald-100/70">Noch keine Inhalte vorhanden.</div>
                {% endfor %}
            </section>

            <aside class="space-y-6">
                <div class="rounded-2xl border border-emerald-500/20 bg-slate-900/80 p-6 backdrop-blur">
                    <h2 class="text-lg font-semibold text-emerald-100">Suchen</h2>
                    <div class="mt-4 flex gap-2">
                        <input placeholder="Suchen..." class="w-full rounded-lg border border-emerald-500/30 bg-slate-900 px-3 py-2 text-sm text-emerald-100 placeholder:text-emerald-200/50" />
                        <button class="rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-slate-950 hover:bg-emerald-400">Suchen</button>
                    </div>
                </div>
                <div class="rounded-2xl border border-emerald-500/20 bg-slate-900/80 p-6 backdrop-blur">
                    <h2 class="text-lg font-semibold text-emerald-100">Neueste Beitr√§ge</h2>
                    <ul class="mt-4 space-y-3 text-sm text-emerald-100/70">
                        <li class="border-b border-emerald-500/20 pb-3">Hallo Welt!</li>
                        <li class="border-b border-emerald-500/20 pb-3">Season Cup Recap</li>
                        <li>Roster Update</li>
                    </ul>
                </div>
            </aside>
        </div>
    </div>
</div>
{% endblock %}
