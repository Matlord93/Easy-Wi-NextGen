<div id="templates-table" class="overflow-hidden" hx-trigger="templates-changed from:body" hx-get="/admin/templates/table" hx-swap="outerHTML">
    <table class="min-w-full divide-y divide-slate-200 text-sm">
        <thead class="bg-slate-50 text-xs uppercase text-slate-700">
            <tr>
                <th class="px-5 py-3 text-left font-semibold">{{ t('admin_templates_table_template', page_locale()) }}</th>
                <th class="px-5 py-3 text-left font-semibold">{{ t('admin_templates_table_ports', page_locale()) }}</th>
                <th class="px-5 py-3 text-left font-semibold">{{ t('admin_templates_table_start_params', page_locale()) }}</th>
                <th class="px-5 py-3 text-left font-semibold">{{ t('admin_templates_table_commands', page_locale()) }}</th>
                <th class="px-5 py-3 text-left font-semibold">{{ t('admin_templates_table_switch_flags', page_locale()) }}</th>
                <th class="px-5 py-3 text-left font-semibold">{{ t('admin_templates_table_actions', page_locale()) }}</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-slate-200 bg-white">
            {% for template in templates %}
                <tr class="hover:bg-slate-50">
                    <td class="px-5 py-4">
                        <div class="font-semibold text-slate-900">{{ template.display_name }}</div>
                        <div class="text-xs text-slate-700 mt-1">Key: {{ template.game_key }}</div>
                        {% if template.steam_app_id %}
                            <div class="text-xs text-slate-700 mt-1">Steam App ID: {{ template.steam_app_id }}</div>
                        {% endif %}
                        {% if template.sniper_profile %}
                            <div class="text-xs text-slate-700 mt-1">Sniper: {{ template.sniper_profile }}</div>
                        {% endif %}
                        {% if template.description %}
                            <div class="text-xs text-slate-700 mt-1">{{ template.description }}</div>
                        {% endif %}
                        <div class="text-xs text-slate-600 mt-2">Updated {{ template.updated_at|date('Y-m-d H:i') }}</div>
                    </td>
                    <td class="px-5 py-4">
                        <div class="flex flex-wrap gap-2">
                            {% for port in template.required_ports %}
                                <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs font-semibold text-slate-600">
                                    {{ port.label ?? port.name }} Â· {{ port.protocol|upper }}
                                </span>
                            {% else %}
                                <span class="text-xs text-slate-600">{{ t('admin_templates_no_ports', page_locale()) }}</span>
                            {% endfor %}
                        </div>
                    </td>
                    <td class="px-5 py-4">
                        <div class="text-xs text-slate-600 whitespace-pre-line">{{ template.start_params }}</div>
                    </td>
                    <td class="px-5 py-4">
                        <div class="text-xs text-slate-600">
                            <p><span class="font-semibold text-slate-700">{{ t('admin_templates_install_label', page_locale()) }}:</span> {{ template.install_command }}</p>
                            <p class="mt-2"><span class="font-semibold text-slate-700">{{ t('admin_templates_update_label', page_locale()) }}:</span> {{ template.update_command }}</p>
                        </div>
                    </td>
                    <td class="px-5 py-4">
                        <div class="flex flex-wrap gap-2">
                            {% for flag in template.allowed_switch_flags %}
                                <span class="inline-flex items-center rounded-full border border-indigo-200 bg-indigo-50 px-2.5 py-1 text-xs font-semibold text-indigo-700">{{ flag }}</span>
                            {% else %}
                                <span class="text-xs text-slate-600">{{ t('admin_templates_no_flags', page_locale()) }}</span>
                            {% endfor %}
                        </div>
                    </td>
                    <td class="px-5 py-4">
                        <div class="flex flex-col gap-2">
                            <a
                                class="rounded-lg border border-slate-200 px-3 py-2 text-xs font-semibold text-slate-600 text-center"
                                href="/admin/templates/{{ template.id }}/preview"
                            >{{ t('admin_templates_preview', page_locale()) }}</a>
                            <a
                                class="rounded-lg border border-indigo-200 bg-indigo-50 px-3 py-2 text-xs font-semibold text-indigo-700 text-center"
                                href="/admin/templates/{{ template.id }}/edit"
                            >{{ t('edit', page_locale()) }}</a>
                        </div>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="6" class="px-5 py-10 text-center text-sm text-slate-700">{{ t('admin_templates_empty', page_locale()) }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
