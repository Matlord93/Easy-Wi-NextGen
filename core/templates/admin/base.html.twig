<!DOCTYPE html>
<html lang="{{ pageLocale|default(page_locale()) }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        (function () {
            const storedTheme = localStorage.getItem('theme');
            if (storedTheme === 'light') {
                document.documentElement.classList.remove('dark');
            } else {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
    <title>{% block title %}Easy-Wi NextGen{% endblock %}</title>
    <link rel="stylesheet" href="/ui.css">
    <link rel="stylesheet" href="/admin-customer.css">
    <script src="/htmx.min.js"></script>
</head>
<body class="admin-interface bg-slate-100 text-slate-900">
{% set activeNav = activeNav|default('') %}
<input id="sidebar-toggle" type="checkbox" class="peer sr-only">
<div class="min-h-screen flex">
    <label for="sidebar-toggle" class="fixed inset-0 z-30 hidden bg-slate-900/40 peer-checked:block lg:hidden" aria-label="{{ t('toggle_sidebar', page_locale()) }}"></label>
    <aside class="fixed inset-y-0 left-0 z-40 w-64 -translate-x-full bg-gradient-to-b from-indigo-700 via-slate-900 to-slate-950 text-slate-100 shadow-xl transition-transform peer-checked:translate-x-0 lg:translate-x-0 lg:static lg:flex lg:flex-col">
        {% set activeNav = activeNav|default('') %}
        <div class="px-6 py-5 text-lg font-semibold tracking-tight">Easy-Wi NextGen</div>
        <nav class="flex-1 px-4 space-y-4">
            <details class="nav-group group" data-nav-id="admin-overview" open>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_overview', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    <a href="/admin" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'dashboard' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'dashboard' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 3.75A.75.75 0 0 1 3.75 3h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5A.75.75 0 0 1 3 8.25v-4.5Zm8 0a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 .75.75v8.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-8.5Zm-8 8a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5A.75.75 0 0 1 3 16.25v-4.5Zm8 2a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-2.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_dashboard', page_locale()) }}</span>
                    </a>
                    <a href="/admin/activity" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'activity' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'activity' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M10 3.5a.75.75 0 0 1 .75.75v5.44l3.22 1.86a.75.75 0 1 1-.75 1.3l-3.6-2.08a.75.75 0 0 1-.37-.65V4.25A.75.75 0 0 1 10 3.5Zm0 13A6.5 6.5 0 1 0 3.5 10a6.5 6.5 0 0 0 6.5 6.5Zm0 1.5A8 8 0 1 1 18 10a8 8 0 0 1-8 8Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('activity', page_locale()) }}</span>
                    </a>
                    <a href="/admin/audit-logs" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'audit-logs' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'audit-logs' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M9.25 4.75a.75.75 0 0 1 .75-.75h4a2 2 0 0 1 2 2v6.5a.75.75 0 0 1-1.5 0V6a.5.5 0 0 0-.5-.5h-3.25V15a.75.75 0 0 1-1.5 0V4.75Zm-4 2A2.25 2.25 0 0 1 7.5 4.5h.25v1.5H7.5a.75.75 0 0 0-.75.75V16a.75.75 0 0 0 .75.75h5a.75.75 0 0 0 .75-.75v-1.25h1.5V16a2.25 2.25 0 0 1-2.25 2.25h-5A2.25 2.25 0 0 1 5.25 16V6.75Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_audit_logs', page_locale()) }}</span>
                    </a>
                </div>
            </details>

            <details class="nav-group group" data-nav-id="admin-accounts" open>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_accounts', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    <a href="/admin/profile" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'profile' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'profile' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M10 11.5a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm-6 6.5a6 6 0 0 1 12 0Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_profile', page_locale()) }}</span>
                    </a>
                    <a href="/admin/users" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'users' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'users' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M10 10a3 3 0 1 0-3-3 3 3 0 0 0 3 3Zm-6 7a6 6 0 0 1 12 0v.25a.75.75 0 0 1-.75.75h-10.5A.75.75 0 0 1 4 17.25Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_users', page_locale()) }}</span>
                    </a>
                    <a href="/admin/billing" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'billing' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'billing' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M4 3.75A1.75 1.75 0 0 1 5.75 2h5.5A1.75 1.75 0 0 1 13 3.75v2h1.25A1.75 1.75 0 0 1 16 7.5v8.75A1.75 1.75 0 0 1 14.25 18H5.75A1.75 1.75 0 0 1 4 16.25V3.75Zm1.5 0V5.75H11V3.75a.25.25 0 0 0-.25-.25h-5a.25.25 0 0 0-.25.25Zm6.75 3.5H5.75a.25.25 0 0 0-.25.25v8.75c0 .14.11.25.25.25h8.5a.25.25 0 0 0 .25-.25V7.5a.25.25 0 0 0-.25-.25Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_billing', page_locale()) }}</span>
                    </a>
                    <a href="/admin/tickets" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'tickets' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'tickets' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M4 4.75A.75.75 0 0 1 4.75 4h10.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-.75.75H4.75A.75.75 0 0 1 4 7.25v-2.5Zm0 8a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-.75.75H4.75a.75.75 0 0 1-.75-.75v-2.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_tickets', page_locale()) }}</span>
                    </a>
                </div>
            </details>

            <details class="nav-group group" data-nav-id="admin-operations" open>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_operations', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    <a href="/admin/jobs" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'jobs' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'jobs' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 4.75A1.75 1.75 0 0 1 4.75 3h10.5A1.75 1.75 0 0 1 17 4.75v10.5A1.75 1.75 0 0 1 15.25 17H4.75A1.75 1.75 0 0 1 3 15.25V4.75Zm3 2.75a.75.75 0 0 0 0 1.5h8a.75.75 0 0 0 0-1.5H6Zm0 4a.75.75 0 0 0 0 1.5h5a.75.75 0 0 0 0-1.5H6Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_jobs', page_locale()) }}</span>
                    </a>
                </div>
            </details>

            {% set infrastructureActive = activeNav in ['nodes', 'bootstrap-tokens', 'metrics', 'templates', 'plugins', 'modules', 'ddos', 'security', 'port-pools', 'port-blocks', 'settings'] %}
            <details class="nav-group group" data-nav-id="admin-infrastructure" {{ infrastructureActive ? 'open' : '' }}>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_infrastructure', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    {% set nodesActive = activeNav == 'nodes' %}
                    <a href="/admin/nodes" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ nodesActive ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ nodesActive ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M9.5 3.75a.75.75 0 0 1 1.5 0v1.06a3.5 3.5 0 0 1 2.45 1.35.75.75 0 1 1-1.2.9A2 2 0 0 0 10.5 6.5h-1A2 2 0 0 0 7.7 7.06a.75.75 0 0 1-1.2-.9A3.5 3.5 0 0 1 9.5 4.81V3.75Zm-4.75 9a2.75 2.75 0 0 1 2.75-2.75h5a2.75 2.75 0 0 1 2.75 2.75v.75a2.75 2.75 0 0 1-2.75 2.75h-5A2.75 2.75 0 0 1 4.75 13.5v-.75Zm2.75-1.25a1.25 1.25 0 0 0-1.25 1.25v.75a1.25 1.25 0 0 0 1.25 1.25h5a1.25 1.25 0 0 0 1.25-1.25v-.75a1.25 1.25 0 0 0-1.25-1.25h-5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_nodes', page_locale()) }}</span>
                    </a>
                    {% set bootstrapTokensActive = activeNav == 'bootstrap-tokens' %}
                    <a href="/admin/agent-bootstrap-tokens" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ bootstrapTokensActive ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ bootstrapTokensActive ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M10 2.75a.75.75 0 0 1 .75.75v1.1a4.5 4.5 0 0 1 3.4 3.4h1.1a.75.75 0 0 1 0 1.5h-1.1a4.5 4.5 0 0 1-3.4 3.4v1.1a.75.75 0 0 1-1.5 0v-1.1a4.5 4.5 0 0 1-3.4-3.4H3.75a.75.75 0 0 1 0-1.5h1.1a4.5 4.5 0 0 1 3.4-3.4v-1.1a.75.75 0 0 1 .75-.75Zm0 3a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_bootstrap_tokens', page_locale()) }}</span>
                    </a>
                    {% set portBlocksActive = activeNav == 'port-blocks' %}
                    <a href="/admin/port-blocks" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ portBlocksActive ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ portBlocksActive ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M5.75 3A1.75 1.75 0 0 0 4 4.75v6.5A1.75 1.75 0 0 0 5.75 13h1.5v1.25a.75.75 0 0 0 1.5 0V13h2v1.25a.75.75 0 0 0 1.5 0V13h1.5A1.75 1.75 0 0 0 15.5 11.25v-6.5A1.75 1.75 0 0 0 13.75 3h-8Zm0 1.5h8a.25.25 0 0 1 .25.25v6.5a.25.25 0 0 1-.25.25h-8a.25.25 0 0 1-.25-.25v-6.5a.25.25 0 0 1 .25-.25Zm2.25 2.25h4a.75.75 0 0 1 0 1.5h-4a.75.75 0 0 1 0-1.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_port_blocks', page_locale()) }}</span>
                    </a>
                    {% set portPoolsActive = activeNav == 'port-pools' %}
                    <a href="/admin/port-pools" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ portPoolsActive ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ portPoolsActive ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M9.25 3a.75.75 0 0 1 .75.75V5h3.5a2.75 2.75 0 0 1 0 5.5H13v.75a.75.75 0 0 1-1.5 0v-.75H8.5v.75a.75.75 0 0 1-1.5 0v-.75H6.5a2.75 2.75 0 0 1 0-5.5H8.5V3.75A.75.75 0 0 1 9.25 3Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_port_pools', page_locale()) }}</span>
                    </a>
                    <a href="/admin/security" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'security' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'security' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M10 2.75a.75.75 0 0 1 .75.75v1.06a5.5 5.5 0 0 1 4 5.3v3.5a2.75 2.75 0 0 1-1.94 2.62l-2.64.88a.75.75 0 0 1-.47 0l-2.64-.88A2.75 2.75 0 0 1 5.25 13.36v-3.5a5.5 5.5 0 0 1 4-5.3V3.5a.75.75 0 0 1 .75-.75Zm-3.25 7.11v3.5c0 .54.34 1.03.86 1.2l2.39.8 2.39-.8c.52-.17.86-.66.86-1.2v-3.5a4 4 0 1 0-8 0Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_security', page_locale()) }}</span>
                    </a>
                    <a href="/admin/settings" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'settings' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'settings' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M10 3a1 1 0 0 1 1 1v.5a.75.75 0 0 0 1.5 0V4a2.5 2.5 0 0 0-5 0v.5a.75.75 0 0 0 1.5 0V4a1 1 0 0 1 1-1Zm-4.5 7a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0Zm4.5-3a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm-7 3a7 7 0 0 1 12.7-3.96.75.75 0 0 1-1.2.9A5.5 5.5 0 1 0 16.5 10a.75.75 0 0 1 1.5 0 7 7 0 0 1-14 0Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_settings', page_locale()) }}</span>
                    </a>
                    <a href="/admin/ddos" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'ddos' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'ddos' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M9.25 3a.75.75 0 0 1 .75.75V5h3.5a2.75 2.75 0 0 1 0 5.5H13v.75a.75.75 0 0 1-1.5 0v-.75H8.5v.75a.75.75 0 0 1-1.5 0v-.75H6.5a2.75 2.75 0 0 1 0-5.5H8.5V3.75A.75.75 0 0 1 9.25 3Zm-2.75 4.5a1.25 1.25 0 0 0 0 2.5h7a1.25 1.25 0 0 0 0-2.5h-7Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_ddos_policy', page_locale()) }}</span>
                    </a>
                    {% set metricsActive = activeNav == 'metrics' %}
                    <a href="/admin/metrics" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ metricsActive ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ metricsActive ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M2.5 3.75a.75.75 0 0 1 .75-.75h13.5a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75H3.25a.75.75 0 0 1-.75-.75V3.75Zm2.25 2.75a.75.75 0 0 0 0 1.5h2a.75.75 0 0 0 0-1.5h-2Zm4 3.5a.75.75 0 0 0 0 1.5h2a.75.75 0 0 0 0-1.5h-2Zm4-3.5a.75.75 0 0 0 0 1.5h2a.75.75 0 0 0 0-1.5h-2Zm-8 7a.75.75 0 0 0 0 1.5h10a.75.75 0 0 0 0-1.5h-10Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_metrics', page_locale()) }}</span>
                    </a>
                    <a href="/admin/templates" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'templates' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'templates' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 5.75A2.75 2.75 0 0 1 5.75 3h8.5A2.75 2.75 0 0 1 17 5.75v8.5A2.75 2.75 0 0 1 14.25 17h-8.5A2.75 2.75 0 0 1 3 14.25v-8.5Zm2.75-1.25a1.25 1.25 0 0 0-1.25 1.25v8.5a1.25 1.25 0 0 0 1.25 1.25h8.5a1.25 1.25 0 0 0 1.25-1.25v-8.5a1.25 1.25 0 0 0-1.25-1.25h-8.5Zm1.75 2.25h5a.75.75 0 0 1 0 1.5h-5a.75.75 0 0 1 0-1.5Zm0 4h5a.75.75 0 0 1 0 1.5h-5a.75.75 0 0 1 0-1.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_templates', page_locale()) }}</span>
                    </a>
                    <a href="/admin/plugins" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'plugins' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'plugins' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M6.5 3.5a3 3 0 1 1 5.18 2.01l.82.82a3.5 3.5 0 1 1-2.47 2.12l-.8-.8A3 3 0 0 1 6.5 3.5Zm1.5 0a1.5 1.5 0 1 0 2.75.87l-.3-.3A1.5 1.5 0 0 0 8 3.5Zm6.5 5a2 2 0 1 0 1.41.59A2 2 0 0 0 14.5 8.5Zm-6.2 3.1.8.8a3.5 3.5 0 0 1-1.92 1.92l-.8-.8a2.5 2.5 0 0 0 1.92-1.92Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_plugins', page_locale()) }}</span>
                    </a>
                    <a href="/admin/modules" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'modules' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'modules' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M7.5 2.75a.75.75 0 0 1 .75.75v1.04a3.5 3.5 0 0 1 2.5 3.36v.6a3.5 3.5 0 0 1-1.57 2.92l-.18.12v2.46a.75.75 0 0 1-1.5 0v-2.46l-.18-.12A3.5 3.5 0 0 1 5.75 8.5v-.6a3.5 3.5 0 0 1 2.5-3.36V3.5a.75.75 0 0 1 .75-.75Zm.75 3.46a2 2 0 0 0-1 1.74v.6a2 2 0 0 0 1 1.74l.5.33.5-.33a2 2 0 0 0 1-1.74v-.6a2 2 0 0 0-1-1.74l-.5-.33-.5.33Zm5 7.04a.75.75 0 0 1 .75.75v.75a1.75 1.75 0 0 1-1.75 1.75H4.75A1.75 1.75 0 0 1 3 15.75V15a.75.75 0 0 1 1.5 0v.75c0 .14.11.25.25.25h7.5a.25.25 0 0 0 .25-.25V15a.75.75 0 0 1 .75-.75Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_modules', page_locale()) }}</span>
                    </a>
                </div>
            </details>

            {% set publicPortalActive = activeNav in ['cms-pages', 'downloads', 'changelog', 'docs', 'public-servers', 'status-components', 'status-maintenance', 'status-incidents'] %}
            <details class="nav-group group" data-nav-id="admin-public-portal" {{ publicPortalActive ? 'open' : '' }}>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_public_portal', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    <a href="/admin/cms/pages" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'cms-pages' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'cms-pages' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M4.75 3A1.75 1.75 0 0 0 3 4.75v10.5C3 16.216 3.784 17 4.75 17h10.5A1.75 1.75 0 0 0 17 15.25V7.5a.75.75 0 0 0-.75-.75h-4.5A1.25 1.25 0 0 1 10.5 5.5V3.75A.75.75 0 0 0 9.75 3h-5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('cms_pages_title', page_locale()) }}</span>
                    </a>
                    <a href="/admin/downloads" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'downloads' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'downloads' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M10 3a.75.75 0 0 1 .75.75v6.69l2.22-2.22a.75.75 0 1 1 1.06 1.06l-3.5 3.5a.75.75 0 0 1-1.06 0l-3.5-3.5a.75.75 0 1 1 1.06-1.06l2.22 2.22V3.75A.75.75 0 0 1 10 3Zm-6 11.25a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H4.75a.75.75 0 0 1-.75-.75Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_downloads', page_locale()) }}</span>
                    </a>
                    <a href="/admin/changelog" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'changelog' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'changelog' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M5.75 3A1.75 1.75 0 0 0 4 4.75v10.5C4 16.216 4.784 17 5.75 17h8.5A1.75 1.75 0 0 0 16 15.25V7.5a.75.75 0 0 0-.75-.75H11A1.25 1.25 0 0 1 9.75 5.5V3.75A.75.75 0 0 0 9 3H5.75Zm2 6.25a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5H8.5a.75.75 0 0 1-.75-.75Zm0 3a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5H8.5a.75.75 0 0 1-.75-.75Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_changelog', page_locale()) }}</span>
                    </a>
                    <a href="/admin/docs" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'docs' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'docs' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M6.5 3.75A1.75 1.75 0 0 0 4.75 5.5v9A1.75 1.75 0 0 0 6.5 16.25h7A1.75 1.75 0 0 0 15.25 14.5V7.414a1.75 1.75 0 0 0-.513-1.237l-1.664-1.664A1.75 1.75 0 0 0 11.836 4H6.5Zm1.25 4.25a.75.75 0 0 1 .75-.75h4a.75.75 0 0 1 0 1.5h-4a.75.75 0 0 1-.75-.75Zm0 3a.75.75 0 0 1 .75-.75h4a.75.75 0 0 1 0 1.5h-4a.75.75 0 0 1-.75-.75Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_docs', page_locale()) }}</span>
                    </a>
                    <a href="/admin/servers" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'public-servers' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'public-servers' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 4.75A1.75 1.75 0 0 1 4.75 3h10.5A1.75 1.75 0 0 1 17 4.75v10.5A1.75 1.75 0 0 1 15.25 17H4.75A1.75 1.75 0 0 1 3 15.25V4.75Zm2.75 1.25a.75.75 0 0 0-.75.75v6a.75.75 0 0 0 .75.75h8.5a.75.75 0 0 0 .75-.75v-6a.75.75 0 0 0-.75-.75h-8.5Zm1.75 2.25h5a.75.75 0 0 1 0 1.5h-5a.75.75 0 0 1 0-1.5Zm0 3h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_server_directory', page_locale()) }}</span>
                    </a>
                    {% set statusActive = activeNav in ['status-components', 'status-maintenance', 'status-incidents'] %}
                    <a href="/admin/status/components" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ statusActive ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ statusActive ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M4.75 3A1.75 1.75 0 0 0 3 4.75v10.5C3 16.216 3.784 17 4.75 17h10.5A1.75 1.75 0 0 0 17 15.25V9.5a.75.75 0 0 0-.75-.75h-4.5A1.25 1.25 0 0 1 10.5 7.5V3.75A.75.75 0 0 0 9.75 3h-5ZM6 12.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Zm0-3.5a.75.75 0 0 1 .75-.75h4a.75.75 0 0 1 0 1.5h-4A.75.75 0 0 1 6 9.25Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_status', page_locale()) }}</span>
                    </a>
                </div>
            </details>

            {% set servicesActive = activeNav in ['game-instances', 'ts3-instances', 'ts6', 'webspaces', 'databases'] %}
            <details class="nav-group group" data-nav-id="admin-services" {{ servicesActive ? 'open' : '' }}>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_services', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    <a href="/admin/webspaces" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'webspaces' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'webspaces' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 4.75A1.75 1.75 0 0 1 4.75 3h10.5A1.75 1.75 0 0 1 17 4.75v10.5A1.75 1.75 0 0 1 15.25 17H4.75A1.75 1.75 0 0 1 3 15.25V4.75Zm2.25 1.75a.75.75 0 0 0 0 1.5h9.5a.75.75 0 0 0 0-1.5h-9.5Zm0 4a.75.75 0 0 0 0 1.5h9.5a.75.75 0 0 0 0-1.5h-9.5Zm0 4a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5h-6Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_webspaces', page_locale()) }}</span>
                    </a>
                    <a href="/admin/databases" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'databases' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'databases' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 4.75A1.75 1.75 0 0 1 4.75 3h10.5A1.75 1.75 0 0 1 17 4.75v10.5A1.75 1.75 0 0 1 15.25 17H4.75A1.75 1.75 0 0 1 3 15.25V4.75Zm1.5 1.5h11v1.5h-11v-1.5Zm0 3.5h11v1.5h-11v-1.5Zm0 3.5h11v1.5h-11v-1.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_databases', page_locale()) }}</span>
                    </a>
                    <a href="/admin/instances" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'game-instances' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'game-instances' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M9 2.75a2.75 2.75 0 1 1 2 2.65v1.1h1.5a2.75 2.75 0 0 1 0 5.5H11v2.25a2.75 2.75 0 1 1-1.5 0V12H8a2.75 2.75 0 0 1 0-5.5h1.5V5.4A2.75 2.75 0 0 1 9 2.75Zm-1 7a1.25 1.25 0 0 0 0 2.5h4.5a1.25 1.25 0 0 0 0-2.5H8Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_game_instances', page_locale()) }}</span>
                    </a>
                    <a href="/admin/ts3/instances" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'ts3-instances' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'ts3-instances' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M4 3.75A1.75 1.75 0 0 1 5.75 2h8.5A1.75 1.75 0 0 1 16 3.75v12.5A1.75 1.75 0 0 1 14.25 18h-8.5A1.75 1.75 0 0 1 4 16.25V3.75Zm2.75.75a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm0 4.25a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm0 4.25a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_ts3_instances', page_locale()) }}</span>
                    </a>
                    {% if module_enabled('ts6') %}
                        <a href="/admin/ts6" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'ts6' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                            <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'ts6' ? 'bg-white/15' : 'bg-white/10' }}">
                                <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path d="M3 4.75A1.75 1.75 0 0 1 4.75 3h10.5A1.75 1.75 0 0 1 17 4.75v10.5A1.75 1.75 0 0 1 15.25 17H4.75A1.75 1.75 0 0 1 3 15.25V4.75Zm2.75 1.25a.75.75 0 0 0-.75.75v6a.75.75 0 0 0 .75.75h8.5a.75.75 0 0 0 .75-.75v-6a.75.75 0 0 0-.75-.75h-8.5Zm1.75 2.25h5a.75.75 0 0 1 0 1.5h-5a.75.75 0 0 1 0-1.5Zm0 3h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5Z"/>
                                </svg>
                            </span>
                            <span class="text-sm font-medium">{{ t('admin_nav_ts6', page_locale()) }}</span>
                        </a>
                    {% endif %}
                </div>
            </details>

            {% set domainsActive = activeNav in ['dns-records', 'mailboxes', 'mail-aliases'] %}
            <details class="nav-group group" data-nav-id="admin-domains-mail" {{ domainsActive ? 'open' : '' }}>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_domains_mail', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    <a href="/admin/dns/records" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'dns-records' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'dns-records' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M4.75 4A1.75 1.75 0 0 1 6.5 2.25h7A1.75 1.75 0 0 1 15.25 4v2.25h-1.5V4a.25.25 0 0 0-.25-.25h-7A.25.25 0 0 0 6.25 4v2.25h-1.5V4Zm-1.5 5.25A1.75 1.75 0 0 1 5 7.5h10a1.75 1.75 0 0 1 1.75 1.75v4.5A1.75 1.75 0 0 1 15 15.5H5a1.75 1.75 0 0 1-1.75-1.75v-4.5Zm3.25.75a.75.75 0 0 0 0 1.5h5a.75.75 0 0 0 0-1.5h-5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_dns_records', page_locale()) }}</span>
                    </a>
                    <a href="/admin/mailboxes" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'mailboxes' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'mailboxes' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 5.75A2.75 2.75 0 0 1 5.75 3h8.5A2.75 2.75 0 0 1 17 5.75v8.5A2.75 2.75 0 0 1 14.25 17h-8.5A2.75 2.75 0 0 1 3 14.25v-8.5Zm2.75-1.25a1.25 1.25 0 0 0-1.25 1.25v.5l5.75 3.2 5.75-3.2v-.5a1.25 1.25 0 0 0-1.25-1.25h-8.5Zm9.75 3.3-4.85 2.7a1.5 1.5 0 0 1-1.3 0L4.5 7.8v6.45a1.25 1.25 0 0 0 1.25 1.25h8.5a1.25 1.25 0 0 0 1.25-1.25V7.8Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_mailboxes', page_locale()) }}</span>
                    </a>
                    <a href="/admin/mail-aliases" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'mail-aliases' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'mail-aliases' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M2.5 6.75A2.75 2.75 0 0 1 5.25 4h9.5A2.75 2.75 0 0 1 17.5 6.75v5.5A2.75 2.75 0 0 1 14.75 15h-2.5v1.25a.75.75 0 0 1-1.5 0V15h-5.5A2.75 2.75 0 0 1 2.5 12.25v-5.5Zm2.75-1.25a1.25 1.25 0 0 0-1.25 1.25v.6l5.5 2.85 5.5-2.85v-.6a1.25 1.25 0 0 0-1.25-1.25h-9.5Zm11.25 3.8-4.65 2.4a1.5 1.5 0 0 1-1.4 0l-4.65-2.4v2.95A1.25 1.25 0 0 0 5.25 13.5h9.5A1.25 1.25 0 0 0 16 12.25V9.3Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_mail_aliases', page_locale()) }}</span>
                    </a>
                </div>
            </details>

            {% set extensionItems = extension_menu_items('admin') %}
            <details class="nav-group group" data-nav-id="admin-extensions" open>
                <summary class="flex items-center justify-between rounded-lg px-3 py-2 text-xs font-semibold uppercase tracking-wide text-indigo-100/80 hover:text-white">
                    <span>{{ t('admin_nav_group_extensions', page_locale()) }}</span>
                    <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.17l3.71-3.94a.75.75 0 1 1 1.08 1.04l-4.25 4.5a.75.75 0 0 1-1.08 0l-4.25-4.5a.75.75 0 0 1 .02-1.06Z"/>
                    </svg>
                </summary>
                <div class="mt-2 space-y-1">
                    <a href="/admin/marketplace" class="flex items-center gap-3 rounded-lg px-3 py-2 {{ activeNav == 'marketplace' ? 'bg-white/10 text-white shadow-inner ring-1 ring-white/10' : 'text-indigo-100/80 transition hover:bg-white/10 hover:text-white' }}">
                        <span class="flex h-8 w-8 items-center justify-center rounded-md {{ activeNav == 'marketplace' ? 'bg-white/15' : 'bg-white/10' }}">
                            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path d="M3 4.75A1.75 1.75 0 0 1 4.75 3h10.5A1.75 1.75 0 0 1 17 4.75v10.5A1.75 1.75 0 0 1 15.25 17H4.75A1.75 1.75 0 0 1 3 15.25V4.75Zm1.5 0v10.5c0 .14.11.25.25.25h10.5a.25.25 0 0 0 .25-.25V4.75a.25.25 0 0 0-.25-.25H4.75a.25.25 0 0 0-.25.25Zm2.25 2.25h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1 0-1.5Zm0 3.5h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1 0-1.5Z"/>
                            </svg>
                        </span>
                        <span class="text-sm font-medium">{{ t('admin_nav_marketplace', page_locale()) }}</span>
                    </a>
                    {% for item in extensionItems %}
                        <a href="{{ item.href }}" class="flex items-center gap-3 rounded-lg px-3 py-2 text-indigo-100/80 transition hover:bg-white/10 hover:text-white">
                            <span class="flex h-8 w-8 items-center justify-center rounded-md bg-white/10">
                                {% if item.iconSvg %}
                                    {{ item.iconSvg|raw }}
                                {% else %}
                                    <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                        <path d="M10 3.5a2.5 2.5 0 0 1 2.45 2h1.8a1.75 1.75 0 0 1 1.75 1.75v1.5a1.75 1.75 0 0 1-1.75 1.75h-1.8a2.5 2.5 0 0 1-4.9 0h-1.8A1.75 1.75 0 0 1 4 10.75v-1.5A1.75 1.75 0 0 1 5.75 7.5h1.8A2.5 2.5 0 0 1 10 3.5Zm0 1.5a1 1 0 0 0-1 1v1.25H5.75a.25.25 0 0 0-.25.25v1.5c0 .14.11.25.25.25H9V11a1 1 0 1 0 2 0V9.75h3.25a.25.25 0 0 0 .25-.25v-1.5a.25.25 0 0 0-.25-.25H11V6a1 1 0 0 0-1-1Z"/>
                                    </svg>
                                {% endif %}
                            </span>
                            <span class="text-sm font-medium">{{ item.label }}</span>
                        </a>
                    {% endfor %}
                </div>
            </details>
        </nav>
        <div class="px-6 py-4 text-xs text-slate-600/70">{{ t('admin_panel_tagline', page_locale()) }}</div>
    </aside>

    <main class="portal-main flex-1 flex flex-col lg:ml-0">
        <header class="sticky top-0 z-20 bg-slate-800/95 text-white backdrop-blur border-b border-slate-700 shadow-sm">
            <div class="flex items-center justify-between px-4 py-4 sm:px-6">
                <div class="flex items-center gap-3 w-full">
                    <label for="sidebar-toggle" class="inline-flex h-10 w-10 items-center justify-center rounded-lg border border-slate-600 bg-slate-700/50 text-slate-200 transition hover:bg-slate-700 lg:hidden">
                        <span class="sr-only">{{ t('admin_toggle_sidebar', page_locale()) }}</span>
                        <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path d="M3 5.75A.75.75 0 0 1 3.75 5h12.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 5.75Zm0 4A.75.75 0 0 1 3.75 9h12.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 9.75Zm0 4a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z"/>
                        </svg>
                    </label>
                    <div class="relative w-full max-w-xl">
                        <input
                            id="global-search-input"
                            type="search"
                            name="q"
                            placeholder="{{ t('global_search_placeholder', page_locale()) }}"
                            aria-label="{{ t('global_search_placeholder', page_locale()) }}"
                            autocomplete="off"
                            class="w-full rounded-lg border border-slate-600 bg-slate-700 px-4 py-2 text-sm text-white placeholder-slate-300 focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-300/40"
                            hx-get="/admin/search"
                            hx-trigger="keyup changed delay:300ms"
                            hx-target="#global-search-results"
                            hx-swap="innerHTML"
                        >
                        <div class="mt-1 text-xs text-slate-600">{{ t('search_help', page_locale()) }}</div>
                        <div id="global-search-results" class="absolute left-0 right-0 top-full z-30 mt-2 rounded-xl border border-slate-600 bg-white shadow-lg"></div>
                    </div>
                </div>
                <div class="hidden items-center gap-4 sm:flex">
                    <button
                        id="theme-toggle"
                        class="rounded-lg border border-slate-600 bg-slate-700/50 px-3 py-2 text-xs font-medium text-slate-100 transition hover:bg-slate-700"
                        aria-label="{{ t('toggle_theme', page_locale()) }}"
                    >{{ t('toggle_theme', page_locale()) }}</button>
                    <div class="flex items-center gap-2">
                        <a
                            href="/dashboard"
                            class="rounded-lg border border-slate-600 bg-slate-700/50 px-3 py-2 text-xs font-medium text-slate-100 transition hover:bg-slate-700"
                        >{{ t('customer_portal', page_locale()) }}</a>
                        <a
                            href="/logout"
                            class="rounded-lg border border-slate-600 bg-slate-700/50 px-3 py-2 text-xs font-medium text-slate-100 transition hover:bg-slate-700"
                        >{{ t('logout', page_locale()) }}</a>
                    </div>
                    <a
                        href="/admin/notifications"
                        class="btn relative rounded-lg border border-slate-600 bg-slate-700/50 px-3 py-2 text-xs font-medium text-slate-100 transition hover:bg-slate-700"
                        aria-label="{{ t('notifications', page_locale()) }}"
                    >
                        {{ t('notifications', page_locale()) }}
                        {% set notificationCount = unread_notifications() %}
                        {% if notificationCount > 0 %}
                            <span class="absolute -right-2 -top-2 inline-flex h-5 min-w-[1.25rem] items-center justify-center rounded-full bg-rose-500 px-1 text-[10px] font-semibold text-white">{{ notificationCount }}</span>
                        {% endif %}
                    </a>
                    <div class="flex items-center gap-3">
                        <div class="text-right">
                            <p class="text-sm font-semibold text-slate-900">{{ t('admin_user_label', page_locale()) }}</p>
                            <p class="text-xs text-slate-600">{{ t('admin_user_role', page_locale()) }}</p>
                        </div>
                        <div class="h-10 w-10 rounded-full bg-indigo-500 text-white flex items-center justify-center font-semibold">A</div>
                    </div>
                </div>
                <div class="flex items-center gap-3 sm:hidden">
                    <div class="h-9 w-9 rounded-full bg-indigo-500 text-white flex items-center justify-center text-sm font-semibold text-slate-900">A</div>
                </div>
            </div>
        </header>

        <section class="mx-auto w-full max-w-6xl px-4 py-6 sm:px-6">
            {% block content %}{% endblock %}
        </section>
    </main>
</div>
<script>
    const navGroups = document.querySelectorAll('details[data-nav-id]');
    navGroups.forEach((group) => {
        const key = `nav-group:${group.dataset.navId}`;
        const stored = localStorage.getItem(key);
        if (stored !== null) {
            group.open = stored === 'open';
        }
        group.addEventListener('toggle', () => {
            localStorage.setItem(key, group.open ? 'open' : 'closed');
        });
    });

    document.addEventListener('keydown', (event) => {
        if (event.key === '/' && document.activeElement?.tagName !== 'INPUT') {
            const search = document.getElementById('global-search-input');
            if (search) {
                event.preventDefault();
                search.focus();
            }
        }
    });

    const themeToggle = document.getElementById('theme-toggle');
    if (themeToggle) {
        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });
    }
</script>
</body>
</html>
