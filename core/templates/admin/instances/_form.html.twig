<div class="p-6 border-b border-slate-200">
    <h2 class="text-lg font-semibold">{{ t('admin_instances_provision_title', page_locale()) }}</h2>
    <p class="text-sm text-slate-500">{{ t('admin_instances_provision_intro', page_locale()) }}</p>
</div>
<form class="p-6 space-y-4"
      hx-post="{{ form.action_url }}"
      hx-target="#instance-form"
      hx-swap="outerHTML">
    {% if form.errors is not empty %}
        <div class="rounded-lg border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700">
            <ul class="list-disc pl-4 space-y-1">
                {% for error in form.errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <div class="grid grid-cols-1 gap-4">
        <label class="block text-sm font-medium text-slate-700">
            {{ t('admin_instances_customer_label', page_locale()) }}
            <select name="customer_id" class="mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm">
                <option value="">{{ t('admin_instances_customer_placeholder', page_locale()) }}</option>
                {% for customer in customers %}
                    <option value="{{ customer.id }}" {{ customer.id == form.customer_id ? 'selected' : '' }}>{{ customer.email }}</option>
                {% endfor %}
            </select>
        </label>
        <label class="block text-sm font-medium text-slate-700">
            {{ t('admin_instances_template_label', page_locale()) }}
            <select name="template_id" class="mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm">
                <option value="">{{ t('admin_instances_template_placeholder', page_locale()) }}</option>
                {% for template in templates %}
                    <option value="{{ template.id }}" {{ template.id == form.template_id ? 'selected' : '' }}>
                        {{ template.displayName }} ({{ template.gameKey }})
                    </option>
                {% endfor %}
            </select>
        </label>
        <label class="block text-sm font-medium text-slate-700">
            {{ t('admin_instances_node_label', page_locale()) }}
            <select name="node_id" class="mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm">
                <option value="">{{ t('admin_instances_node_placeholder', page_locale()) }}</option>
                {% for node in nodes %}
                    <option value="{{ node.id }}" {{ node.id == form.node_id ? 'selected' : '' }}>{{ node.name ?? node.id }}</option>
                {% endfor %}
            </select>
        </label>
    </div>

    <div class="grid grid-cols-1 gap-4 md:grid-cols-3">
        <label class="block text-sm font-medium text-slate-700">
            {{ t('admin_instances_cpu_limit', page_locale()) }}
            <input name="cpu_limit" type="number" min="1" value="{{ form.cpu_limit }}" class="mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm" placeholder="2">
        </label>
        <label class="block text-sm font-medium text-slate-700">
            {{ t('admin_instances_ram_limit', page_locale()) }}
            <input name="ram_limit" type="number" min="256" value="{{ form.ram_limit }}" class="mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm" placeholder="4096">
        </label>
        <label class="block text-sm font-medium text-slate-700">
            {{ t('admin_instances_disk_limit', page_locale()) }}
            <input name="disk_limit" type="number" min="1024" value="{{ form.disk_limit }}" class="mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm" placeholder="20000">
        </label>
    </div>

    <label class="block text-sm font-medium text-slate-700">
        {{ t('admin_instances_port_block', page_locale()) }}
        <input name="port_block_id" value="{{ form.port_block_id }}" class="mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm" placeholder="{{ t('admin_instances_port_block_placeholder', page_locale()) }}">
    </label>

    <button class="w-full rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white">
        {{ t(form.submit_label, page_locale()) }}
    </button>
</form>
